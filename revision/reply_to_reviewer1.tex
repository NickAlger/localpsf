\documentclass[11pt]{article}
\renewcommand*\familydefault{\sfdefault}
%\usepackage{amssymb,amsmath,amsfonts,comment}
%\usepackage{amsmath,amssymb,graphicx,subfigure,psfrag}
\usepackage{amsmath,amssymb,graphicx,subfigure,psfrag,upgreek}
\usepackage{amssymb,mathrsfs}
\usepackage[margin=1in]{geometry}
\usepackage{tikz,pgfplots,graphicx}
\usepackage{color,pdfcolmk}
\usepackage{amsmath}

%\newcommand{\alennote}[1]{\noindent\emph{\textcolor{blue!50!black}{Alen:#1\:}}}
%\newcommand{\gsnote}[1]{\noindent\emph{\textcolor{green}{GS: #1\:}}}
\newcommand{\todo}[1]{\noindent\emph{\textcolor{red}{Todo: #1\:}}}
\newcommand{\note}[1]{\noindent\emph{\vspace{1ex}\textcolor{blue}{Note: #1\:}}\\[1ex]}
\newcommand{\nnote}[1]{\noindent\emph{\vspace{1ex}\textcolor{red}{Note: #1\:}}}
\newcommand{\referee}[1]{\vspace{.1ex}\noindent{\textcolor{blue}{#1}}}
\newcommand{\nnn}{\mathbf{n}}
\newcommand{\fff}{\mathbf{f}}
\newcommand{\uuu}{\mathbf{u}}
\newcommand{\+}{\otimes}
\newcommand{\m}{\mathcal}
\newcommand{\bs}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\eps}{\varepsilon}


\newcommand{\gs}[1]{\textcolor{green}{G: #1}}
\newcommand{\np}[1]{\textcolor{blue}{N: #1}}
\newcommand{\tuck}[1]{\textcolor{brown}{T: #1}}
\newcommand{\mauro}[1]{\textcolor{red}{#1}}



\begin{document}

\section*{Reply to the Reviewer 1:}

Thanks for the careful reading and for your helpful comments and
suggestions.  Please find below point-by-point replies (in black) to
your comments and questions (which are reprinted in blue). To give you
an overview of all the changes in the paper, we also provide a
diff-document that highlights the changes between the initial
submission and this re-submission.\\[1ex]

\referee{Many Hessian-based computational algorithms have been
  developed to solve large-scale inverse problems constrained by
  partial differential equations (PDEs) in the last decade, especially
  in the context of inferring infinite-dimensional
  parameters. However, it remains a critical computational challenge
  to solve such inverse problems when the Hessian of the data-misfit
  term does not have fast spectrum decay, or the Hessian is
  high-rank. This challenge often leads to the need to solve a
  considerable number of PDEs in many (preconditioned) CG iterations
  with an inexact Newton-CG algorithm, one of the most advanced
  optimization algorithms in solving infinite-dimensional inverse
  problems.\\}

  \referee{To address this challenge, this paper proposes an
  efficient preconditioned CG method with the preconditioner computed
  as an approximate Hessian at some suitable parameter point, which is
  demonstrated to significantly reduce the number of required CG
  iterations to achieve given accuracy. The key novelty of this paper
  is the development of an efficient hierarchical matrix approximation
  of the Hessian using only a small number of Hessian matrix-vector
  products, thus a small number of PDE solves. This novelty is made
  possible by exploiting the property of the Hessian operator with
  locally supported non-negative integral kernels. Specifically, the
  authors propose a point spread function (PSF) approximation of the
  Hessian by (1) computing the zeroth, first, and second-order
  impulse response moments of the Hessian by applying its product with
  constant, linear, and quadratic functions, (2) building local
  ellipsoid support es- timate of the impulse response functions of
  the Hessian based on these moments, (3) selecting sample points of
  the impulse response from a candidate set by a greedy ellipsoid
  packing algorithm, (4) computing the impulse responses with disjoint
  ellipsoid in batches by applying the Hessian to Dirac combs, which
  plays a key role in reducing the total number of Hessian
  matrix-vector product, (5) approximating any integral kernel entries
  by a radial basis interpolation based on the computed impulse
  responses, and (6) building the hierarchical matrix approximation of
  the Hessian with the radial basis interpolation of the integral
  kernel entries before applying proper symmetrizing and flipping of
  the negative eigenvalues to make the approximate matrix symmetric
  positive semi-definite.\\}

\referee{The PSF approximation in this paper is built for more general
  operators than Hessian. It demonstrates the effectiveness of the
  PSF-based method by 1 using it to build preconditioners for the
  Hessian operator in two challenging inverse problems of basal
  friction coefficient inversion of ice sheet flow and ini- tial
  condition inversion of advection-dominated transport. It shows
  significant reductions (5-10X) in the required number of PDE solves
  compared to classical regularization-based preconditioning and no
  preconditioning. The paper also presents a comprehensive numerical
  study on the influence of various parameters (data noises, \# batchs,
  diffusion coefficients, terminal times) on the effective- ness and
  data-scalability of the proposed method, showing that the PSF-based
  preconditioners can form good approximations of high-rank Hessians
  using only a small number of operator applications.  The proposed
  method is very interesting and makes a great contribution to solving
  large-scale inverse problems with high-rank Hessians. The
  presentation of the proposed method is concise and illustrative. The
  numerical results are very convincing. Overall, the paper is very
  well written.\\}

\referee{Thank you for the positive assesment of our work.\\}

\paragraph{General Comments:}

\referee{I recommend to accept the paper for publication with minor
  revisions. I suggest the authors properly address the following
  questions to help for its better understanding and broader
  applications.\\}

\begin{enumerate} 
\item \referee{The author mentioned one limitation of the proposed method:
      the Hessian should have a local non-negative integral kernel,
      which is not satisfied for wave inverse problems that lead to a
      substantial amount of negative entries of the Hessian. It would
      be interesting if the author could elaborate more details with
      intuition or numerical evidence for this property and the
      limitation, especially if you also use Gauss-Newton approximate
      Hessian for the wave inverse problems as in this paper.}

\noindent{Nick will try to get an impulse response for the wave
  problem.}

\item \referee{It is interesting to see the effectiveness of the
  approximate Hessian used as a preconditioner. It would also be very
  interesting to see how accurate the approximate Hessian is compared
  to a full Hessian in terms of the number of batches, ellipsoid
  sizes, and in particular the total number of impulse responses. Can
  you say anything about the convergence of the approximation, either
  numerical or theoretical?}

  \noindent{Nick will try to create a plot that shows some error
    (e.g. Frob norm, cond number) as a function of number of impulse
    responses.}

 \item \referee{The paper presented a nice complexity analysis of the steps in
    constructing the approximate Hessian, with the dominating cost
    arising from the Hessian matrix-vector product. It would be
    interesting to see the computational time of each step for the
    numerical examples to provide a good sense of the complexity and
    to support the 5-10X computational reduction by accounting also
    the overhead beyond the PDE solves.}

   \noindent{Nick will time one of the examples in the
     advection-diffusion.}
   
\end{enumerate} 

%\bibliographystyle{unsrt}
%\bibliographystyle{iopart-num}
%\bibliography{reviewer2_references}

\end{document}
